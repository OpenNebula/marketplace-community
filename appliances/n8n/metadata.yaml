---
:app:
  :name: n8n
  :type: service
  :os:
    :type: linux
    :base: ubuntu2204
  :hypervisor: KVM
  :opennebula_version:
    - '7.0'
  :opennebula_template:
    context:
      - SSH_PUBLIC_KEY="$USER[SSH_PUBLIC_KEY]"
      - SET_HOSTNAME="$USER[SET_HOSTNAME]"
    cpu: '2'
    memory: '2048'
    disk_size: '8192'
    graphics:
      listen: 0.0.0.0
      type: vnc
    inputs_order: 'CONTAINER_NAME,CONTAINER_PORTS,CONTAINER_ENV,CONTAINER_VOLUMES'
    logo: logos/n8n.png
    user_inputs:
      CONTAINER_NAME: 'M|text|Container name|n8n-container|n8n-container'
      CONTAINER_PORTS: 'M|text|Container ports (format: host:container)|5678:5678|5678:5678'
      CONTAINER_ENV: 'O|text|Environment variables (format: VAR1=value1,VAR2=value2)|N8N_HOST=0.0.0.0,N8N_PORT=5678,N8N_PROTOCOL=http,N8N_SECURE_COOKIE=false|'
      CONTAINER_VOLUMES: 'O|text|Volume mounts (format: /host/path:/container/path)|/data:/home/node/.n8n|'

  :context:
    :prefixed: true
    :params:
      :CONTAINER_NAME: 'n8n-container'
      :CONTAINER_PORTS: '5678:5678'
      :CONTAINER_ENV: 'N8N_HOST=0.0.0.0,N8N_PORT=5678,N8N_PROTOCOL=http,N8N_SECURE_COOKIE=false'
      :CONTAINER_VOLUMES: '/data:/home/node/.n8n'

:one:
  :template:
    NAME: base
    TEMPLATE:
      ARCH: x86_64
      CONTEXT:
        NETWORK: 'YES'
        SSH_PUBLIC_KEY: "$USER[SSH_PUBLIC_KEY]"
      CPU: '2'
      CPU_MODEL:
        MODEL: host-passthrough
      GRAPHICS:
        LISTEN: 0.0.0.0
        TYPE: vnc
      MEMORY: '2048'
      NIC:
        NETWORK: vnet
      NIC_DEFAULT:
        MODEL: virtio
  :datastore_name: default
  :timeout: '90'

:infra:
  :disk_format: qcow2
  :apps_path: /var/tmp
